<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho - Padaria Medeiros</title>
    <link rel="stylesheet" href="../CSS/style.css">
</head>
<body>
<header>
    <h1>Padaria Medeiros</h1>
    <nav>
        <a href="produtos.html">Produtos</a>
        <a href="carrinho.html">Carrinho</a>
        <a href="sobre.html">Sobre</a>
    </nav>
</header>

<main>
    <h2>üõí Seu Carrinho</h2>
    <div id="carrinho-container"></div>
    <h3>Total: <span id="total">R$ 0,00</span></h3>

    <div class="botoes-carrinho">
        <button onclick="finalizarCompra()">‚úÖ Finalizar Compra</button>
        <button onclick="cancelarCompra()" style="background-color: #c0392b; color: white;">‚ùå Cancelar Compra</button>
    </div>
</main>

<script>

    function carregarCarrinho() {
        const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
        const container = document.getElementById("carrinho-container");
        container.innerHTML = "";
        let total = 0;

        if (carrinho.length === 0) {
            container.innerHTML = "<p>Seu carrinho est√° vazio üò¢</p>";
            document.getElementById("total").innerText = "R$ 0,00";
            return;
        }

        carrinho.forEach((item, index) => {
            const subtotal = item.qtd * item.preco;
            total += subtotal;

            const card = document.createElement("div");
            card.className = "carrinho-item";
            card.innerHTML = `
                <h4>${item.nome}</h4>
                <p>Qtd: ${item.qtd} | Pre√ßo Unit: R$ ${item.preco.toFixed(2)}</p>
                <p>Subtotal: R$ ${subtotal.toFixed(2)}</p>
                <button onclick="removerItem(${index})">‚ùå Remover</button>
            `;
            container.appendChild(card);
        });

        document.getElementById("total").innerText = "R$ " + total.toFixed(2);
    }

    function removerItem(index) {
        let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
        carrinho.splice(index, 1);
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        carregarCarrinho();
    }

    function finalizarCompra() {
        const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
        if (carrinho.length === 0) {
            alert("Seu carrinho est√° vazio!");
            return;
        }

        if (confirm("Deseja finalizar a compra?")) {
            const total = document.getElementById("total").innerText.replace("R$ ", "").replace(",", ".");
            localStorage.setItem("totalCompra", total);
            localStorage.removeItem("carrinho");
            window.location.href = "pagamento.html";
        }
    }

    function cancelarCompra() {
        const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
        if (carrinho.length === 0) {
            alert("O carrinho j√° est√° vazio!");
            return;
        }

        if (confirm("Tem certeza que deseja cancelar a compra e esvaziar o carrinho?")) {
            localStorage.removeItem("carrinho");
            carregarCarrinho();
            alert("Compra cancelada e carrinho esvaziado.");
        }
    }

    window.onload = carregarCarrinho;

</script>

</body>
</html>